<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Accueil | e-foncier.ci</title>
        <meta name="description" content="Gestion et valorisation de parcelle en Côte d'Ivoire | ADC CONSULTING | Accueil">
        <meta name="author" content="Kouame Alexandre Paul">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" href="images/favicon.png" sizes="32x32" type="image/png">
        <link rel="stylesheet" href="styles/base.css">
        <link rel="stylesheet" href="styles/base-large.css" media="screen and (min-width: 768px)">
        <link rel="stylesheet" href="styles/parcelle.css">
        <link rel="stylesheet" href="styles/parcelle-large.css" media="screen and (min-width: 768px)">
        <link href="https://api.mapbox.com/mapbox-gl-js/v3.12.0/mapbox-gl.css" rel="stylesheet">
        <script src="https://api.mapbox.com/mapbox-gl-js/v3.12.0/mapbox-gl.js"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Jost:wght@700&family=Roboto&display=swap" rel="stylesheet">
    </head>
    <body>
        <header>
            <div id="main-menu">
                <div class="logo">
                    <a href="index.html">
                        <img src="images/logo-e-foncier-blanc.svg" alt="Logo e foncier" width="250">
                    </a>
                    <a href="#" id="menu" aria-label="menu"></a>
                </div>
                
                <nav>
                    <ul>
                        <li><a href="index.html" class="active">Accueil</a></li>
                        <li><a href="parcelles.html">Parcelles</a></li>
                        <li><a href="#">Experts</a></li>
                        <li><a href="#">Plan</a></li>
                        <li><a href="#">Contact</a></li>
                    </ul>
                    <ul>
                        <li><a href="">Se connecter</a></li>
                        <li><a href="">S'inscrire</a></li>
                    </ul>
                </nav>
            </div>
            <div class="hero">

            </div>
        </header>
        <main>
            <div class="container">
                <div class="map-container">
                    <div class="loading" id="loading">
                        <div>Loading 3D terrain...</div>
                    </div>
            
                    <div class="map-controls">
                        <div class="control-group">
                            <h4>Controls</h4>
                            <button class="toggle-button" id="toggle3D">Enable 3D Terrain</button>
                            <button class="toggle-button" id="toggleBuildings">Show 3D Buildings</button>
                        </div>
            
                        <div class="control-group">
                            <h4>Map Style</h4>
                            <div class="style-selector">
                                <button class="style-button active" data-style="streets">Streets</button>
                                <button class="style-button" data-style="satellite">Satellite</button>
                                <button class="style-button" data-style="satellite-streets">Satellite Streets</button>
                                <button class="style-button" data-style="outdoors">Outdoors</button>
                            </div>
                        </div>
                    </div>
            
                    <div id="map"></div>
                </div>
            
                <div class="info-panel">
            
                    <div class="stats">
                        <div class="stat-card">
                            <div class="stat-value" id="totalParcels">0</div>
                            <div class="stat-label">Total Parcels</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="totalArea">0</div>
                            <div class="stat-label">Total Area (acres)</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="avgPrice">$0</div>
                            <div class="stat-label">Average Price</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="totalValue">$0</div>
                            <div class="stat-label">Total Value</div>
                        </div>
                    </div>
                </div>  </div>
        </main>
        <footer>
            <div class="footer-top">
                <section>
                    <h3>ADC CONSULTING</h3>
                    <p>
                        Abidjan - Cote d'Ivoire / Cocody Angré 
                        9ème tranche derrière l'immeuble CGK.
                        <br>
                        <strong>Email:</strong> info@adc-conseil@.com
                        <br>
                        <strong>Telephone:</strong> +225 27 22 59 68 34
                        <br>
                        <strong>Mobile:</strong> +225 05 46 82 07 07
                    </p>
                </section>
                <section>
                    <h3>e-foncier.ci</h3>
                    <ul>
                        <li>Accueil</li>
                        <li>Parcelles</li>
                        <li>Experts</li>
                        <li>Plan</li>
                        <li>Contact</li>
                    </ul>
                </section>
                <section>
                    <h3>Services</h3>
                    <ul>
                        <li>Estimation et Analyse de Terrain</li>
                        <li>Sécurisation des Transactions Foncières</li>
                        <li>Annonces et Mise en Relation</li>
                        <li>Gestion et Suivi de Propriété</li>
                    </ul>
                </section>
            </div>
            <div class="footer-bottom">
                <p>&copy; Copyright 2025 by <a href="https://adc-conseil.com">ADC CONSULTING</a></p>
                <p>Tous droits Réservés</p>
                <p>
                    <svg fill="#ffffff" height="200px" width="200px" version="1.1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-143 145 512 512" xml:space="preserve">
                        <g>
                            <path
                                d="M113,145c-141.4,0-256,114.6-256,256s114.6,256,256,256s256-114.6,256-256S254.4,145,113,145z M169.5,357.6l-2.9,38.3h-39.3 v133H77.7v-133H51.2v-38.3h26.5v-25.7c0-11.3,0.3-28.8,8.5-39.7c8.7-11.5,20.6-19.3,41.1-19.3c33.4,0,47.4,4.8,47.4,4.8l-6.6,39.2 c0,0-11-3.2-21.3-3.2c-10.3,0-19.5,3.7-19.5,14v29.9H169.5z">
                            </path>
                        </g>
                    </svg>
                    <svg fill="#ffffff" height="200px" width="200px" version="1.1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-143 145 512 512" xml:space="preserve" stroke="#ffffff">
                        <g>
                            <path
                                d="M113,145c-141.4,0-256,114.6-256,256s114.6,256,256,256s256-114.6,256-256S254.4,145,113,145z M41.4,508.1H-8.5V348.4h49.9 V508.1z M15.1,328.4h-0.4c-18.1,0-29.8-12.2-29.8-27.7c0-15.8,12.1-27.7,30.5-27.7c18.4,0,29.7,11.9,30.1,27.7 C45.6,316.1,33.9,328.4,15.1,328.4z M241,508.1h-56.6v-82.6c0-21.6-8.8-36.4-28.3-36.4c-14.9,0-23.2,10-27,19.6 c-1.4,3.4-1.2,8.2-1.2,13.1v86.3H71.8c0,0,0.7-146.4,0-159.7h56.1v25.1c3.3-11,21.2-26.6,49.8-26.6c35.5,0,63.3,23,63.3,72.4V508.1z ">
                            </path>
                        </g>
                    </svg>
                </p>
            </div>
        </footer>
        <script src="scripts/base.js" async defer></script>
        <script>
            // Mapbox access token (using a demo token - replace with your own)
            mapboxgl.accessToken = 'pk.eyJ1IjoiZGVscGlwaSIsImEiOiJjbGd6MTAxZDEwZXdyM2pwbnM0Y3dyMDN0In0.YdF9zdrSgDbp7cz_aj6NCw';

            // Sample land data in GeoJSON format
            const landData = {
                "type": "FeatureCollection",
                "features": [
                {
                        "type": "Feature",
                        "properties": {
                            "id": 1,
                            "name": "Ferme de Yamoussoukro",
                            "landType": "Agricole",
                            "area": 52.5,
                            "price": 800000,
                            "owner": "Famille Konan",
                            "zoning": "AG-1",
                            "description": "Terre fertile idéale pour les cultures vivrières et maraîchères."
                        },
                        "geometry": {
                            "type": "Point",
                            "coordinates": [-5.2767, 6.8170]
                        }
                    },
                    {
                        "type": "Feature",
                        "properties": {
                            "id": 2,
                            "name": "Parcelle résidentielle Riviera",
                            "landType": "Résidentiel",
                            "area": 1.0,
                            "price": 1500000,
                            "owner": "SCI Abidjan Villas",
                            "zoning": "R-1",
                            "description": "Terrain résidentiel prêt à bâtir dans un quartier sécurisé."
                        },
                        "geometry": {
                            "type": "Point",
                            "coordinates": [-3.9864, 5.3480]  // Abidjan (Riviera)
                        }
                    },
                    {
                        "type": "Feature",
                        "properties": {
                            "id": 3,
                            "name": "Zone commerciale Cocody",
                            "landType": "Commercial",
                            "area": 3.2,
                            "price": 4200000,
                            "owner": "Investisseurs Côte d'Ivoire",
                            "zoning": "C-2",
                            "description": "Parcelle stratégique pour centre commercial ou supermarché."
                        },
                        "geometry": {
                            "type": "Point",
                            "coordinates": [-3.9942, 5.3556]
                        }
                    },
                    {
                        "type": "Feature",
                        "properties": {
                            "id": 4,
                            "name": "Zone industrielle San Pedro",
                            "landType": "Industriel",
                            "area": 20.5,
                            "price": 2500000,
                            "owner": "Zone Franche San Pedro",
                            "zoning": "IND",
                            "description": "Site adapté pour entrepôts ou transformation agro-industrielle."
                        },
                        "geometry": {
                            "type": "Point",
                            "coordinates": [-6.6431, 4.7485]
                        }
                    },
                    {
                        "type": "Feature",
                        "properties": {
                            "id": 5,
                            "name": "Parc de loisirs Bouaké",
                            "landType": "Récréatif",
                            "area": 18.7,
                            "price": 600000,
                            "owner": "Mairie de Bouaké",
                            "zoning": "REC-1",
                            "description": "Zone verte pour aire de jeux, pique-nique, et activités sportives."
                        },
                        "geometry": {
                            "type": "Point",
                            "coordinates": [-5.5557, 7.6829]
                        }
                    }
                ]
            };

            // Define colors for different land types
            const landTypeColors = {
                'Agricultural': '#28a745',
                'Residential': '#dc3545',
                'Commercial': '#ffc107',
                'Industrial': '#17a2b8',
                'Recreational': '#6f42c1'
            };

            // Initialize the map
            const map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/streets-v12',
                center: [-5.55, 7.54],
                zoom: 11,
                pitch: 0,
                bearing: 0,
                antialias: true
            });

            let terrain3DEnabled = false;
            let buildingsEnabled = false;

            map.on('load', () => {
                // Add terrain source for 3D
                map.addSource('mapbox-dem', {
                    'type': 'raster-dem',
                    'url': 'mapbox://mapbox.mapbox-terrain-dem-v1',
                    'tileSize': 512,
                    'maxzoom': 14
                });

                // Add land parcels data source
                map.addSource('land-parcels', {
                    'type': 'geojson',
                    'data': landData
                });

                // Add markers layer with different colors based on land type
                map.addLayer({
                    'id': 'land-parcels-layer',
                    'type': 'circle',
                    'source': 'land-parcels',
                    'paint': {
                        'circle-radius': [
                            'interpolate',
                            ['linear'],
                            ['zoom'],
                            10, 8,
                            15, 15
                        ],
                        'circle-color': [
                            'case',
                            ['==', ['get', 'landType'], 'Agricultural'], landTypeColors.Agricultural,
                            ['==', ['get', 'landType'], 'Residential'], landTypeColors.Residential,
                            ['==', ['get', 'landType'], 'Commercial'], landTypeColors.Commercial,
                            ['==', ['get', 'landType'], 'Industrial'], landTypeColors.Industrial,
                            ['==', ['get', 'landType'], 'Recreational'], landTypeColors.Recreational,
                            '#cccccc'
                        ],
                        'circle-stroke-width': 2,
                        'circle-stroke-color': '#ffffff',
                        'circle-opacity': 0.8
                    }
                });

                // Add labels layer
                map.addLayer({
                    'id': 'land-parcels-labels',
                    'type': 'symbol',
                    'source': 'land-parcels',
                    'layout': {
                        'text-field': ['get', 'name'],
                        'text-font': ['Open Sans Semibold', 'Arial Unicode MS Bold'],
                        'text-offset': [0, 1.5],
                        'text-anchor': 'top',
                        'text-size': 12
                    },
                    'paint': {
                        'text-color': '#333333',
                        'text-halo-color': '#ffffff',
                        'text-halo-width': 1
                    }
                });

                // Create popups for land parcels
                map.on('click', 'land-parcels-layer', (e) => {
                    const properties = e.features[0].properties;
                    const coordinates = e.features[0].geometry.coordinates.slice();

                    const popupContent = `
                                <div style="font-family: Arial, sans-serif; max-width: 320px;">
                                    <h3 style="margin: 0 0 12px 0; color: ${landTypeColors[properties.landType]}; font-size: 1.2rem;">
                                        ${properties.name}
                                    </h3>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 12px;">
                                        <div><strong>Type:</strong><br>${properties.landType}</div>
                                        <div><strong>Area:</strong><br>${properties.area} acres</div>
                                        <div><strong>Price:</strong><br>$${properties.price.toLocaleString()}</div>
                                        <div><strong>Zoning:</strong><br>${properties.zoning}</div>
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <strong>Owner:</strong> ${properties.owner}
                                    </div>
                                    <div style="margin-bottom: 12px; font-size: 0.9rem; color: #666;">
                                        ${properties.description}
                                    </div>
                                    <div style="padding: 10px; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 6px; text-align: center;">
                                        <strong>Price per acre:</strong> $${Math.round(properties.price / properties.area).toLocaleString()}
                                    </div>
                                </div>
                            `;

                    // Ensure popup coordinates are valid
                    while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
                        coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
                    }

                    new mapboxgl.Popup({ closeButton: true, closeOnClick: false })
                        .setLngLat(coordinates)
                        .setHTML(popupContent)
                        .addTo(map);
                });

                // Change cursor on hover
                map.on('mouseenter', 'land-parcels-layer', () => {
                    map.getCanvas().style.cursor = 'pointer';
                });

                map.on('mouseleave', 'land-parcels-layer', () => {
                    map.getCanvas().style.cursor = '';
                });
            });

            // 3D Terrain toggle
            document.getElementById('toggle3D').addEventListener('click', function () {
                terrain3DEnabled = !terrain3DEnabled;

                if (terrain3DEnabled) {
                    document.getElementById('loading').style.display = 'block';

                    // Enable 3D terrain
                    map.setTerrain({ 'source': 'mapbox-dem', 'exaggeration': 1.5 });

                    // Animate to a tilted view
                    map.easeTo({
                        pitch: 60,
                        bearing: -17.6,
                        duration: 2000
                    });

                    this.textContent = 'Disable 3D Terrain';
                    this.classList.add('active');

                    setTimeout(() => {
                        document.getElementById('loading').style.display = 'none';
                    }, 2000);
                } else {
                    // Disable 3D terrain
                    map.setTerrain(null);

                    // Return to flat view
                    map.easeTo({
                        pitch: 0,
                        bearing: 0,
                        duration: 1000
                    });

                    this.textContent = 'Enable 3D Terrain';
                    this.classList.remove('active');
                }
            });

            // 3D Buildings toggle
            document.getElementById('toggleBuildings').addEventListener('click', function () {
                buildingsEnabled = !buildingsEnabled;

                if (buildingsEnabled) {
                    // Add 3D buildings layer
                    map.addLayer({
                        'id': '3d-buildings',
                        'source': 'composite',
                        'source-layer': 'building',
                        'filter': ['==', 'extrude', 'true'],
                        'type': 'fill-extrusion',
                        'minzoom': 15,
                        'paint': {
                            'fill-extrusion-color': '#aaa',
                            'fill-extrusion-height': [
                                'interpolate',
                                ['linear'],
                                ['zoom'],
                                15, 0,
                                15.05, ['get', 'height']
                            ],
                            'fill-extrusion-base': [
                                'interpolate',
                                ['linear'],
                                ['zoom'],
                                15, 0,
                                15.05, ['get', 'min_height']
                            ],
                            'fill-extrusion-opacity': 0.6
                        }
                    });

                    this.textContent = 'Hide 3D Buildings';
                    this.classList.add('active');
                } else {
                    // Remove 3D buildings layer
                    if (map.getLayer('3d-buildings')) {
                        map.removeLayer('3d-buildings');
                    }

                    this.textContent = 'Show 3D Buildings';
                    this.classList.remove('active');
                }
            });

            // Style switcher
            const styleButtons = document.querySelectorAll('.style-button');
            const styles = {
                'streets': 'mapbox://styles/mapbox/streets-v12',
                'satellite': 'mapbox://styles/mapbox/satellite-v9',
                'satellite-streets': 'mapbox://styles/mapbox/satellite-streets-v12',
                'outdoors': 'mapbox://styles/mapbox/outdoors-v12'
            };

            styleButtons.forEach(button => {
                button.addEventListener('click', function () {
                    const style = this.dataset.style;

                    // Update active button
                    styleButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');

                    // Change map style
                    map.setStyle(styles[style]);

                    // Re-add layers when style loads
                    map.once('styledata', () => {
                        // Re-add terrain source
                        if (!map.getSource('mapbox-dem')) {
                            map.addSource('mapbox-dem', {
                                'type': 'raster-dem',
                                'url': 'mapbox://mapbox.mapbox-terrain-dem-v1',
                                'tileSize': 512,
                                'maxzoom': 14
                            });
                        }

                        // Re-add land parcels
                        if (!map.getSource('land-parcels')) {
                            map.addSource('land-parcels', {
                                'type': 'geojson',
                                'data': landData
                            });

                            // Re-add layers
                            map.addLayer({
                                'id': 'land-parcels-layer',
                                'type': 'circle',
                                'source': 'land-parcels',
                                'paint': {
                                    'circle-radius': [
                                        'interpolate',
                                        ['linear'],
                                        ['zoom'],
                                        10, 8,
                                        15, 15
                                    ],
                                    'circle-color': [
                                        'case',
                                        ['==', ['get', 'landType'], 'Agricultural'], landTypeColors.Agricultural,
                                        ['==', ['get', 'landType'], 'Residential'], landTypeColors.Residential,
                                        ['==', ['get', 'landType'], 'Commercial'], landTypeColors.Commercial,
                                        ['==', ['get', 'landType'], 'Industrial'], landTypeColors.Industrial,
                                        ['==', ['get', 'landType'], 'Recreational'], landTypeColors.Recreational,
                                        '#cccccc'
                                    ],
                                    'circle-stroke-width': 2,
                                    'circle-stroke-color': '#ffffff',
                                    'circle-opacity': 0.8
                                }
                            });

                            map.addLayer({
                                'id': 'land-parcels-labels',
                                'type': 'symbol',
                                'source': 'land-parcels',
                                'layout': {
                                    'text-field': ['get', 'name'],
                                    'text-font': ['Open Sans Semibold', 'Arial Unicode MS Bold'],
                                    'text-offset': [0, 1.5],
                                    'text-anchor': 'top',
                                    'text-size': 12
                                },
                                'paint': {
                                    'text-color': '#333333',
                                    'text-halo-color': '#ffffff',
                                    'text-halo-width': 1
                                }
                            });
                        }

                        // Restore 3D terrain if it was enabled
                        if (terrain3DEnabled) {
                            map.setTerrain({ 'source': 'mapbox-dem', 'exaggeration': 1.5 });
                        }

                        // Restore 3D buildings if they were enabled
                        if (buildingsEnabled && !map.getLayer('3d-buildings')) {
                            map.addLayer({
                                'id': '3d-buildings',
                                'source': 'composite',
                                'source-layer': 'building',
                                'filter': ['==', 'extrude', 'true'],
                                'type': 'fill-extrusion',
                                'minzoom': 15,
                                'paint': {
                                    'fill-extrusion-color': '#aaa',
                                    'fill-extrusion-height': [
                                        'interpolate',
                                        ['linear'],
                                        ['zoom'],
                                        15, 0,
                                        15.05, ['get', 'height']
                                    ],
                                    'fill-extrusion-base': [
                                        'interpolate',
                                        ['linear'],
                                        ['zoom'],
                                        15, 0,
                                        15.05, ['get', 'min_height']
                                    ],
                                    'fill-extrusion-opacity': 0.6
                                }
                            });
                        }
                    });
                });
            });

            // Calculate and display statistics
            function updateStats() {
                const totalParcels = landData.features.length;
                const totalArea = landData.features.reduce((sum, feature) => sum + feature.properties.area, 0);
                const totalValue = landData.features.reduce((sum, feature) => sum + feature.properties.price, 0);
                const avgPrice = totalValue / totalParcels;

                document.getElementById('totalParcels').textContent = totalParcels;
                document.getElementById('totalArea').textContent = totalArea.toFixed(1);
                document.getElementById('avgPrice').textContent = '$' + Math.round(avgPrice).toLocaleString();
                document.getElementById('totalValue').textContent = '$' + totalValue.toLocaleString();
            }

            // Update statistics
            updateStats();

            // Add navigation controls
            map.addControl(new mapboxgl.NavigationControl(), 'bottom-right');
            map.addControl(new mapboxgl.FullscreenControl(), 'bottom-right');
        </script>
        <script src="scripts/parcelle.js" async defer></script>
    </body>
</html>